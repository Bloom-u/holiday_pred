发明名称
一种基于节假日特征工程与混合专家模型的交通流量预测方法及系统
摘要
本发明公开了一种面向节假日场景的交通流量预测方法及系统。首先构建节假日特征工程模块，区分法定节假日、普通周末与调休工作日，生成假期前后距离、假期强度、假期进度、滞后流量、滚动均值与趋势、节假日与周期性交互等多维高级特征；随后基于混合专家模型建立预测网络，采用分通道特征编码、节假日嵌入融合与双层节假日感知注意力对历史序列建模，并通过包含基础、高流量与低流量专家的自适应预测头输出未来七日流量；训练阶段结合极端过采样与节假日自适应加权Huber损失，对春节、国庆及其他法定节假日样本施加更高权重。本发明在节假日稀疏、流量分布异质的条件下显著提升预测准确性，兼顾模型轻量化与推理速度。
 
权利要求书
1. 一种基于节假日特征工程与混合专家模型的交通流量预测方法，其特征在于，包括如下步骤：
S1：构建节假日特征工程模块，对包含日期与交通流量的原始数据生成多维高级特征，所述高级特征包括节假日类型细分、节假日前后距离与强度、滞后流量、滚动统计、趋势及节假日与周期性组合特征；
S2：基于混合专家架构构建交通流量预测模型，所述模型包含改进的特征编码器、节假日嵌入融合层、双层节假日感知注意力编码器、节假日先验驱动的解码器以及自适应预测头，输出未来连续七日的交通流量预测值；
S3：采用节假日样本极端过采样与自适应加权Huber损失训练所述模型，其中高流量节假日与低流量节假日样本的采样权重与损失权重高于普通日样本。
2. 根据权利要求1所述的方法，其特征在于，步骤S1中所述节假日特征工程模块包括：
（1）节假日类型识别单元，用于区分法定节假日、普通周末与调休工作日，输出是否节假日、节假日名称、节假日类型编码及是否调休工作日；
（2）节假日前后距离特征单元，计算距离最近法定节假日的天数、前一节假日距离、后一节假日距离、最近节假日类型与名称，并生成指数衰减的假期邻近度；
（3）假期阶段与强度特征单元，计算假期总长度、假期进度、假期日序号，生成假期开始、结束、中段标识及假期强度；
（4）节假日类型效应特征单元，基于历史统计为不同节假日分配流量比例系数，并生成高流量节假日标识与低流量节假日标识。
3. 根据权利要求1所述的方法，其特征在于，步骤S1中还包括：
（1）滞后特征提取单元，生成前一日流量、前七日同期流量、前十四日同期流量及近三日平均变化量；
（2）滚动统计与趋势特征单元，计算7日、14日、30日移动平均，7日移动标准差及周级趋势差分；
（3）节假日与周期性交互特征单元，将节假日标识与星期正余弦编码相乘形成交互特征，并生成高流量节假日×假期长度、低流量节假日×假期进度等组合特征；
（4）年度趋势特征单元，对年份进行归一化并对异常年份设置显式标识。
4. 根据权利要求1所述的方法，其特征在于，步骤S2中的改进特征编码器包括：针对滞后流量特征的半维度投影通道、针对连续特征的四分之一维度投影通道、针对二值特征的四分之一维度投影通道，以及用于三类特征拼接后的层归一化与非线性融合网络。
5. 根据权利要求1所述的方法，其特征在于，步骤S2中的节假日感知注意力编码器为两层串联结构，利用节假日类型嵌入与节假日数值特征投影组成的节假日向量与位置编码相加后与编码器输出相融合，并通过多头自注意力与前馈网络进行残差建模。
6. 根据权利要求1所述的方法，其特征在于，步骤S2中的自适应预测头包括基础预测器、高流量节假日专家、低流量节假日专家及门控网络，所述门控网络输出三维Softmax权重，对三个专家输出进行加权求和得到最终预测值。
7. 根据权利要求1所述的方法，其特征在于，步骤S3中的自适应加权Huber损失设定普通日基础权重为1.0，高流量节假日权重为15.0，低流量节假日权重为20.0，对应样本的损失按权重放大后求平均；极端过采样策略中，高流量节假日样本的采样权重不低于25，低流量节假日样本的采样权重不低于30。
8. 一种基于节假日特征工程与混合专家模型的交通流量预测系统，其特征在于，包括：特征工程模块、预测模型模块、训练模块与预测输出模块；其中，特征工程模块执行权利要求1-3任一项所述步骤S1，预测模型模块执行步骤S2，训练模块执行步骤S3，预测输出模块将未来七日流量预测结果进行可视化与评估。
9. 一种计算机可读存储介质，其上存储有计算机程序，所述程序被处理器执行时实现权利要求1-7任一项所述的方法。

 
说明书
一种基于节假日特征工程与混合专家模型的交通流量预测方法及系统
技术领域 
本发明属于智能交通与时间序列预测技术领域，具体涉及一种结合节假日细粒度特征工程与混合专家模型的交通流量预测方法及系统，适用于节假日稀疏、流量波动大的城市道路与高速公路场景。
背景技术 
现有交通流量预测方法在节假日场景下存在三类不足：一是节假日样本比例低且类型差异大，统一建模导致节假日预测偏差显著；二是对调休工作日、法定节假日、普通周末的划分不准确，假期前后出行预热与返程效应常被忽略；三是模型缺乏面向节假日的自适应能力，无法针对高流量假期（国庆、劳动节）与低流量假期（春节）选择不同的预测策略，训练损失对关键场景关注度不足。因此，需要一种兼顾细粒度特征工程、节假日感知建模与差异化训练的预测方案。
发明内容
本发明的目的在于提供一种基于节假日特征工程与混合专家模型的交通流量预测方法及系统，通过精细的节假日特征提取、节假日感知的编码与注意力建模、以及面向节假日的自适应预测与加权训练，显著提升节假日与普通日的预测准确性与稳定性。
技术方案：如权利要求1-9所述，本发明包括特征工程、模型构建、训练与系统实现四部分。
有益效果：本发明通过细分节假日类型并显式建模假期前后距离、假期进度与强度，捕获节前预热与节后余热的出行模式；通过分通道编码、节假日嵌入融合与双层节假日感知注意力，强化模型对节假日时序依赖与异质性的表达能力；通过含基础、高流量、低流量专家的自适应预测头及节假日加权Huber损失，提升国庆、劳动节等高流量假期和春节等低流量假期的预测精度，同时保持整体模型参数量轻量化，适合快速部署。
附图说明
图1为本发明方法的总体流程图；图2为节假日特征工程模块示意图；图3为节假日感知的混合专家模型结构示意图；图4为自适应损失与极端过采样训练流程示意图；图5为节假日预测效果对比示意图。
具体实施方式
以下结合实施例对本发明进行说明。本实施例以14天历史数据预测未来7天交通流量为例，数据包含日期、机动车当量及基础节假日标签。
实施例1：特征工程。使用节假日特征工程模块对原始数据生成基础时间特征（年、月、周、日序、周期正余弦）、节假日核心特征（法定节假日标识、节假日名称、节假日类型编码、调休工作日标识）、节假日前后距离特征（距下一节假日天数、距上一节假日天数、最近节假日类型、假期邻近度）、假期阶段特征（假期总长度、假期进度、假期日序号、开始/中段/结束标识、假期强度）、节假日类型效应特征（高流量假日标识、低流量假日标识、节假日流量比例系数），并进一步生成滞后特征、滚动统计、趋势以及节假日与周期性交互特征，共形成二十余个高级特征。
实施例2：模型构建。将滞后特征、连续特征与二值特征分别输入改进的特征编码器进行分通道投影和融合；将节假日类型嵌入与节假日数值特征投影后与编码器输出及位置编码相加，通过两层节假日感知注意力完成历史序列建模，提取编码器摘要；将未来节假日信息嵌入后作为解码器输入，与编码器摘要相加并经解码注意力得到解码摘要；将编码摘要与解码摘要相加后输入自适应预测头，门控网络对基础、高流量、低流量专家输出进行加权，得到未来七日的预测值。
实施例3：训练策略。训练时对包含春节的样本赋予不少于30的采样权重，对包含国庆节或劳动节的样本赋予不少于25的采样权重，其他法定节假日样本赋予大于普通日的采样权重；损失函数采用Huber Loss，在普通日权重1.0的基础上，对高流量假期损失乘以15，对低流量假期损失乘以20，以提升模型对关键节假日场景的拟合能力。训练完成后，模型参数量约十万量级，满足移动端或边缘设备的快速推理需求。
实施例4：系统实现。系统包括特征工程模块、模型推理模块、训练模块与可视化模块。特征工程模块批量生成并保存高级特征数据；训练模块加载特征数据、执行极端过采样与自适应加权训练并保存模型权重；模型推理模块加载权重，在标准预测与滚动预测模式下输出未来七日流量并可进行加权融合；可视化模块输出时间序列对比、残差分析及节假日分场景误差统计。
本发明提供的技术方案能够在节假日样本稀疏、流量分布异质的条件下有效降低节假日预测误差，并保持整体模型的推理效率。对于本领域普通技术人员，在不脱离本发明原理的前提下所做出的等同替换或变形，均应落入本发明的保护范围。
